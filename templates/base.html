<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Strava x Glucose{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ğŸ—ºï¸ Leaflet (cartes OpenStreetMap) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- ğŸ¨ Police plus fun -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <style>
    :root {
      /* ===== Palette OcÃ©an (bleu/cyan) ===== */
      --bg-page: #f4f7fb;          /* gris bleutÃ© trÃ¨s clair */
      --bg-header: #ffffff;        /* header blanc */
      --bg-card: #ffffff;          /* cartes blanches */

      --accent: #0d6efd;           /* bleu vif (primary) */
      --accent-dark: #0b5ed7;      /* bleu foncÃ© pour hover */
      --accent-2: #0d6efd;         /* cyan pour touches secondaires */

      --text-main: #0f172a;        /* presque noir bleutÃ© */
      --text-muted: #64748b;       /* gris bleutÃ© */
      --border-soft: #e2e8f0;      /* bord doux */
      --shadow-soft: 0 6px 18px rgba(2, 6, 23, 0.06);
      --ring: 0 0 0 3px rgba(37, 99, 235, 0.18);

      /* dÃ©gradÃ©s utiles */
      --grad-accent: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      --link: #2563eb;
      --link-hover: #1d4ed8;
    }

    * { box-sizing: border-box; }

    body {
    margin: 0;
    font-family: "Outfit", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background-color: var(--bg-page);
    color: var(--text-main);
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    /* ğŸ‘‡ on enlÃ¨ve le min-width pour laisser la fenÃªtre se rÃ©trÃ©cir naturellement */
    /* min-width: 1100px;  <-- on supprime cette ligne */
    }

    a {
      color: var(--link);
      text-decoration: none;
      transition: color .15s ease;
    }
    a:hover { color: var(--link-hover); text-decoration: underline; }

    /* ===== Header ===== */
    header {
      background: var(--bg-header);
      border-bottom: 1px solid var(--border-soft);
      padding: 12px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky; top: 0; z-index: 1000;
      backdrop-filter: saturate(1.1) blur(6px);
    }

    .brand {
      display: flex; align-items: center; gap: 10px;
      font-weight: 500; font-size: 0.95rem; letter-spacing: .02em;
      color: var(--text-main);
    }
    .brand a { display:flex; align-items:center; gap:10px; color:inherit; text-decoration:none; }

    .brand-mark {
      width: 28px; height: 28px; border-radius: 8px;
      background: var(--grad-accent);
      display: inline-flex; align-items: center; justify-content: center;
      color: #fff; font-size: .9rem; font-weight: 700;
      box-shadow: 0 4px 12px rgba(37, 99, 235, .25);
    }
    .brand-text { font-weight:500; }
    .brand-home { display:none; font-size:1.3rem; }

    nav { display: flex; align-items: center; gap: 18px; font-size: .95rem; }
    nav a {
      color: #475569; padding: 6px 0; position: relative;
    }
    nav a::after {
      content:""; position:absolute; left:0; bottom:-2px; height:2px; width:0;
      background: var(--grad-accent); transition: width .18s ease;
      border-radius: 2px;
    }
    nav a:hover { color: var(--text-main); }
    nav a:hover::after { width: 100%; }

    .nav-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
    }

    .nav-icon { display: none; font-size: 1.15rem; }
    .nav-label { display: inline; }

    @media (max-width: 640px) {
      .nav-icon { display: inline-flex; }
      .nav-label { display: none; }
      header { padding: 10px 16px; }
      .brand-mark { display:none; }
    .brand-text { display:inline-flex; font-size:0.8rem; }
    .brand-home { display:inline-flex; }
      .nav-link.home-link { display:none; }
    }
  
    /* ===== Layout ===== */
    .container {
      width: min(1100px, 100%);
      margin: 0 auto;
      padding: 2px 1px 3px;
    }

    /* ===== Cards ===== */
    .card {
      background: var(--bg-card);
      border-radius: 4px;
      border: 1px solid var(--border-soft);
      padding: 4px 20px;
      margin-bottom: 6px;
      box-shadow: var(--shadow-soft);
    }
    .card h1, .card h2, .card h3 { margin-top: 0; color: var(--text-main); }
    .muted { color: var(--text-muted); }

    /* ===== Form ===== */
    label {
      display:block; font-size:.8rem; color:#475569; margin-bottom:4px; font-weight:600;
    }

    input[type="text"], input[type="email"], input[type="password"],
    input[type="number"], input[type="date"], select {
      width:100%; padding:10px 12px; font-size:.95rem;
      border-radius:4px; border:1px solid #cbd5e1; background:#fff; color:var(--text-main);
      transition: box-shadow .15s ease, border-color .15s ease, transform .02s;
    }
    input:focus, select:focus {
      outline:none; border-color: var(--accent);
      box-shadow: var(--ring);
    }

    /* ===== Buttons ===== */
    button {
      cursor:pointer; padding:10px 16px; border-radius:2px;
      border:1px solid transparent; font-size:.95rem; font-weight:600;
      background:#0d6efd; color:#fff;
      transition: transform .06s ease, filter .15s ease, box-shadow .15s ease;
      box-shadow: 0 6px 16px rgba(13, 110, 253, .3);
    }
    button:hover { filter: brightness(1.03); }
    button:active { transform: translateY(1px); }

    .btn-secondary {
      background:#ffffff; color:#0f172a; border-color:#cbd5e1;
      box-shadow: 0 3px 10px rgba(2, 6, 23, 0.05);
    }
    .btn-secondary:hover { background:#f8fafc; }

    /* Petits badges/info chips (optionnel) */
    .chip {
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      background: rgba(37,99,235,.08); color:#1e3a8a; font-weight:600; font-size:.8rem;
      border:1px solid rgba(37,99,235,.18);
    }

    /* AccessibilitÃ© focus sur les liens et Ã©lÃ©ments cliquables */
    a:focus-visible, button:focus-visible, .chip:focus-visible {
      outline:none; box-shadow: var(--ring);
      border-radius: 10px;
    }
  
    .leaflet-control-container,
    .leaflet-top,
    .leaflet-bottom,
    .leaflet-left,
    .leaflet-right,
    .leaflet-control {
      z-index: 0 !important;
    }
  </style>

  {% block extra_head %}{% endblock %}
</head>

<body>
  {% set session_user_id = request.session.get('user_id') %}
  <header>
    {% set home_href = '/ui/user/' ~ session_user_id if session_user_id else '/' %}
    <div class="brand">
      <a href="{{ home_href }}">
        <span class="brand-home">ğŸ </span>
        <span class="brand-mark">SxG</span>
        <span class="brand-text">Strava x Glucose</span>
      </a>
    </div>
    <nav>
      {% if session_user_id %}
        <a class="nav-link home-link" href="/ui/user/{{ session_user_id }}">
          <span class="nav-icon">ğŸ </span>
          <span class="nav-label">Home</span>
        </a>
        <a class="nav-link" href="/ui/user/{{ session_user_id }}/profile">
          <span class="nav-icon">ğŸ‘¤</span>
          <span class="nav-label">Profil</span>
        </a>
      {% endif %}
      {% if session_user_id == 1 %}
        <a class="nav-link" href="/ui">
          <span class="nav-icon">ğŸ—‚ï¸</span>
          <span class="nav-label">Admin</span>
        </a>
        <a class="nav-link" href="/docs" target="_blank">
          <span class="nav-icon">ğŸ“˜</span>
          <span class="nav-label">API Docs</span>
        </a>
      {% endif %}
      {% if session_user_id %}
        <a class="nav-link" href="/logout">
          <span class="nav-icon">ğŸšª</span>
          <span class="nav-label">DÃ©connexion</span>
        </a>
      {% endif %}
    </nav>
  </header>

  <div class="container">
    {% block content %}{% endblock %}
  </div>
</body>
</html>
